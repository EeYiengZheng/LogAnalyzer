{% extends "base.html" %}

{% block script_content %}

    $(document).ready(function(){
        $('#sel1').change(function() {
            $("#downloadLog").attr("action", "/uploads/" + $(this).find("option:selected").text());
            $("#chooseAFile").prop('disabled', 'true');
        });

        $('#analyzeBtn').click(function() {
        $.ajax({
            url: '/graphs',
            type: 'GET',
            data: { filename: $("#sel1").find("option:selected").text() },
            success: function(response) {
                $('#feedback').html(response)
            },
            error: function(error) {
                console.log(error);
            }
        });
        });
    });

{% endblock %}

{% block content %}
    <form id="downloadLog" action="#">
        <div class="p-2 form-group">
            <label for="sel1">Uploaded Files:</label>
            <select class="form-control" id="sel1">
                <option id="chooseAFile" class="">Choose a file</option>
                {% for file in files %}
                    <option>{{ file.filename }}</option>
                {% endfor %}
            </select>
            <br>
            <div class="d-flex  justify-content-between">
                <input id="dl-button" type="submit" class="btn btn-primary" value="Download selected file">
                <button id="analyzeBtn" type="button" class="btn btn-primary" >Analyze</button>
            </div>
        </div>
    </form>
    <div id="feedback"></div>
{% endblock %}